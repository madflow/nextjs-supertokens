# Next.js Supertokens Example

> **Disclaimer:** This README was generated by AI

This repository demonstrates authentication using [SuperTokens](https://supertokens.com/) with a [Next.js](https://nextjs.org/) application. It includes a full-stack example with a PostgreSQL backend, a Docker Compose setup, and authentication flows (sign up, sign in, session management, protected API routes).

This project uses a [Turborepo](https://turbo.build/) monorepo structure for managing multiple packages and applications.

**Note:** This repository is not intended as a starter template for production use. It is for demonstration and educational purposes only.

---

## Features

- Next.js 15 app (App Router)
- SuperTokens integration (Email/Password, session management, user roles, dashboard)
- SuperTokens dashboard and user roles are configured and enabled
- PostgreSQL as the SuperTokens storage backend
- Docker Compose for local development
- PGAdmin for database inspection
- Example of protected API routes and client-side authentication
- Managed as a monorepo using Turborepo

---

## SuperTokens Dashboard

The SuperTokens dashboard is enabled and available at:

- [http://localhost:3000/api/auth/dashboard](http://localhost:3000/api/auth/dashboard)

This dashboard allows you to view users, manage user roles, and inspect authentication data. Default access is without authentication for demonstration purposes.

---

## Prerequisites

- [Docker & Docker Compose](https://docs.docker.com/get-docker/) installed
- [Node.js](https://nodejs.org/) v18 or newer
- [npm](https://www.npmjs.com/), [pnpm](https://pnpm.io/), [yarn](https://yarnpkg.com/), or [bun](https://bun.sh/) (choose one)

---

## Getting Started

### 1. Clone the repository

```bash
git clone <this-repo-url>
cd nextjs-supertokens
```

### 2. Setup environment variables

Copy the example environment file and adjust if needed:

```bash
cp .env.dist .env
```

The default values are suitable for local development. You can adjust `POSTGRES_USER`, `POSTGRES_PASSWORD`, and `POSTGRES_DB` if desired.

### 3. Start the backend services (PostgreSQL, SuperTokens, PGAdmin)

```bash
docker-compose up --build
```

- PostgreSQL: `localhost:5432`
- SuperTokens core: `localhost:3567`
- PGAdmin UI: `localhost:5050` (default login: `admin@example.com` / `admin`)

### 4. Install dependencies (in a separate terminal)

```bash
npm install
```

### 5. Start the Next.js app

```bash
npm run dev
```

Visit [http://localhost:3000](http://localhost:3000) to see the app.

---

## How It Works

- Authentication: SuperTokens is configured for email/password login and session management. The backend (API routes) and frontend (React components) are protected using SuperTokens middleware and providers.
- Protected Routes: `/private` and `/api/private` require authentication. Public routes are accessible to everyone.
- Database: The PostgreSQL database is initialized with an `auth` schema (see `docker/initdb/001-auth.sql`). SuperTokens stores user and session data in this schema.
- PGAdmin: Used for inspecting the database during development.

---

## Project Structure

- `apps/web` — Next.js application
- `docker-compose.yml` — Defines PostgreSQL, SuperTokens, and PGAdmin services
- `docker/initdb/001-auth.sql` — Initializes the PostgreSQL `auth` schema
- `packages/` — Shared configs (TypeScript, ESLint)

---

## Customization & Production

- For production, update environment variables for secure passwords, domains, and API keys.
- See [SuperTokens docs](https://supertokens.com/docs) for advanced configuration (social login, JWT, RBAC, etc).

---

## Useful Links

- [SuperTokens Documentation](https://supertokens.com/docs)
- [Next.js Documentation](https://nextjs.org/docs)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
